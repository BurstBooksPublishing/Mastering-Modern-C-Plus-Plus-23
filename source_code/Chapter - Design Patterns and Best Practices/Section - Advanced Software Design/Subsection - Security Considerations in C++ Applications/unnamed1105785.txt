#include <sodium.h>
#include <stdexcept>
#include <string>

std::string hashPassword(const std::string& password) {
    if (sodium_init() < 0) {
        throw std::runtime_error("libsodium initialization failed");
    }

    char hashed[crypto_pwhash_STRBYTES];
    if (crypto_pwhash_str(hashed,
                          password.c_str(),
                          password.size(),
                          crypto_pwhash_OPSLIMIT_INTERACTIVE,
                          crypto_pwhash_MEMLIMIT_INTERACTIVE) != 0) {
        throw std::runtime_error("Password hashing failed");
    }
    return hashed;
}